<%- include('fragments/header') %>
<%- include('fragments/barnav') %>

<h1>Tableau de Bord</h1>
<div class="container_tab_bord">

    <aside class="sidebar left">
        <h2>Autres programmes</h2>
        <button id='btn_prog1' onclick="changeTab('div_prog1')" class='tablink'>Nombre premier</button>
        <button id='btn_prog2' onclick="changeTab('div_prog2')" class='tablink'>Pi_Montecarlo</button>
        <button id='btn_prog3' onclick="changeTab('div_prog3')" class='tablink'>Calcul Intégral Simpson</button>
        <button id='btn_scal' onclick="changeTab('scalab')" class='tablink'>Scalabilité</button>
    </aside>

    <section class="main">
        <?php foreach ($modules as $key => $m): ?>
        <div id="<?php echo $m['id']; ?>" class="tabcontent">
            <form method="POST" class="form-box">
                <h2><?php echo $m['titre']; ?></h2>

                <label><h3>Sélection du programme</h3></label>
                <select name="script">
                    <?php foreach ($m['scripts'] as $s): ?>
                    <option value="<?php echo $s['file']; ?>"><?php echo $s['name']; ?></option>
                    <?php endforeach; ?>
                </select>

                <h3>Sélection des workers</h3>
                <label for="pi1">Node 1</label>
                <input type="checkbox" id="pi1" name="pi1" value="pi1">
                <label for="pi2">Node 2</label>
                <input type="checkbox" id="pi2" name="pi2" value="pi2">
                <label for="pi3">Node 3</label>
                <input type="checkbox" id="pi3" name="pi3" value="pi3">
                <label for="pi4">Node 4</label>
                <input type="checkbox" id="pi4" name="pi4" value="pi4">
                <label for="cnat">Contrôleur</label>
                <input type="checkbox" id="cnat" name="cnat" value="cnat">

                <?php foreach ($m['inputs'] as $input): ?>
                <label for="<?php echo $input['name']; ?>"><?php echo $input['label']; ?></label>
                <input type="<?php echo $input['type']; ?>" name="<?php echo $input['name']; ?>" required>
                <?php endforeach; ?>

                <div class="resultat"><?php echo $resultat; ?></div>
                <input type="hidden" name="module" value="<?php echo $key; ?>">
                <button type="submit" name="lancer">Lancer</button>
            </form>
        </div>
        <?php endforeach; ?>
        <div id="scalab" class="tabcontent">
            <form method="POST" class="form-box">

                <label><h3>Sélection du programme</h3></label>
                <select name="script">
                    <option value="prime">prime</option>
                    <option value="prime_improve">prime_improve</option>
                    <option value="prime_DLB">prime_DLB</option>
                    <option value="prime_DLB_improve">prime_DLB_improve</option>
                    <option value="MPI">MC MPI</option>
                    <option value="javaSocket">MC JavaSocket</option>
                    <option value="pythonSocket">MC PythonSocket</option>
                </select>

                <select name="mode_sc">
                    <option value="strong scalab">Scalabilité forte</option>
                    <option value="weak scalab">Scalabilité faible</option>
                </select>

                <input type="hidden" name="scal" value="scal">
                <button type="submit" name="lancer">Lancer</button>
            </form>
            <img src="data:image/png;base64,<?= $img ?>" alt="Graphique">
        </div>
    </section>


</div>

<script>

    function changeTab(tab) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName('tabcontent');
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = 'none';
        }
        tablinks = document.getElementsByClassName('tablink');
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].style.backgroundColor = '';
        }
        document.getElementById(tab).style.display ='block';

    }
    //au chargement de la page après une exécution du formulaire
    window.onload = function() {
        changeTab('<?php echo $activeTab; ?>');
    };
</script>

<%- include('fragments/footer') %>

